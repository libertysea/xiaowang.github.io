<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>hadoop总结及词频统计进阶 | LibertySea</title><meta name="author" content="LibertySea"><meta name="copyright" content="LibertySea"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="提醒本文来自博主期末课程论文如对文中数据及代码有所需要,可联系博主获取:::danger文章的引用,必须联系博主获取权限::: 引言随着互联网的出现和通信技术的不断进步，数据的产生和传播速度以及数据的传播范围迅速增加，并且数据呈现爆炸性增长。大数据（big data）一词越来越多地被提及，人们用它来描述和定义信息爆炸时代产生的海量数据，并命名与之相关的技术发展与创新。大数据同过去海量数据有所区别">
<meta property="og:type" content="article">
<meta property="og:title" content="hadoop总结及词频统计进阶">
<meta property="og:url" content="http://blog.xiaowang.icu/2023/01/13/computer-science/big-data/hadoop/hadoop%E6%80%BB%E7%BB%93%E5%8F%8A%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E8%BF%9B%E9%98%B6/index.html">
<meta property="og:site_name" content="LibertySea">
<meta property="og:description" content="提醒本文来自博主期末课程论文如对文中数据及代码有所需要,可联系博主获取:::danger文章的引用,必须联系博主获取权限::: 引言随着互联网的出现和通信技术的不断进步，数据的产生和传播速度以及数据的传播范围迅速增加，并且数据呈现爆炸性增长。大数据（big data）一词越来越多地被提及，人们用它来描述和定义信息爆炸时代产生的海量数据，并命名与之相关的技术发展与创新。大数据同过去海量数据有所区别">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciundwu5j20zk0m8n9e.jpg">
<meta property="article:published_time" content="2023-01-13T13:13:48.000Z">
<meta property="article:modified_time" content="2023-02-06T14:21:45.520Z">
<meta property="article:author" content="LibertySea">
<meta property="article:tag" content="hadoop">
<meta property="article:tag" content="HDFS">
<meta property="article:tag" content="MapReduce">
<meta property="article:tag" content="词频统计">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciundwu5j20zk0m8n9e.jpg"><link rel="shortcut icon" href="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/20230128205654.png"><link rel="canonical" href="http://blog.xiaowang.icu/2023/01/13/computer-science/big-data/hadoop/hadoop%E6%80%BB%E7%BB%93%E5%8F%8A%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E8%BF%9B%E9%98%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"JNYANDZFQ0","apiKey":"549fe353c3c6b975953f6b86c78e016c","indexName":"LibertySea","hits":{"per_page":10},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":100,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":200},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'hadoop总结及词频统计进阶',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-02-06 22:21:45'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/readPercent.css"><link rel="stylesheet" href="/css/mouse.css"><link rel="stylesheet" href="/css/hometop.css"><link rel="stylesheet" href="/css/bbTime.css"><link rel="stylesheet" href="/css/categoryBar.css"><link rel="stylesheet" href="/css/random.css"><link rel="stylesheet" href="/css/swip.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/mainColor/heoMainColor.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.css"><link rel="stylesheet" href="/css/footer.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/nav_menu.css"><link rel="stylesheet" href="/css/nav_test.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Jayhrn/fontawesome-pro/css/all.min.css"><link rel="stylesheet" href="https://npm.elemecdn.com/remixicon@2.5.0/fonts/remixicon.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/l-lin/font-awesome-animation/dist/font-awesome-animation.min.css"  media="defer" onload="this.media='all'"><span id="fps"></span><link rel="stylesheet" href="/css/jike.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn1.tianli0.top/npm/element-ui@2.15.6/packages/theme-chalk/lib/index.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_3871375_n12pe0fwv7a.css"  media="defer" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/bb/showbb_in_index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css"><link rel="stylesheet" href="/css/globalstyle.css"><svg aria-hidden="true" style="position:absolute; overflow:hidden; width:0; height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css"/>
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="/css/swiperstyle.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><div class="loading-img"></div><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> { preloader.endLoading() })

if (false) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="/css/progress_bar.css"/><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/v2-99baee7dfbc714d5498a770bf3ec6d77_r.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-chuansong"></use></svg><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-annual-report"></use></svg><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tag"></use></svg><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan4"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:randomPost();"><span> 随机访问</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-chuansong"></use></svg><span> 我的</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan6"></use></svg><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/source/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-feiyuguantou"></use></svg><span> 资源库</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-kafei"></use></svg><span> 社交</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shejiaotubiao-38"></use></svg><span> 即刻</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan10"></use></svg><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-feiji1"></use></svg><span> 关于</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/echarts/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/me/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tilamisu"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essaay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-baomihua"></use></svg><span> 闲言碎语</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><!-- - const { darkmode } = theme--><!-- nav#nav--><!--   span#blog_name--><!--     .back-home-button(tabindex='-1')--><!--       i.back-home-button-icon.fas.fa-grip-vertical--><!--       .back-menu-list-groups--><!--         .back-menu-list-group--><!--           .back-menu-list-title 网页--><!--           .back-menu-list--><!--             a.back-menu-item(href='/', title='前往博客主页', target='_blank', one-link-mark='yes')--><!--               img.back-menu-item-icon(src='https://img02.anzhiy.cn/adminuploads/1/2022/09/05/6315ec9737ac4.png')--><!--               span.back-menu-item-text 博客--><!--             a.back-menu-item(href='https://www.cloud.anzhiy.cn/', rel='external nofollow', title='前往云盘主页', target='_blank', one-link-mark='yes')--><!--               img.back-menu-item-icon(src='https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg')--><!--               span.back-menu-item-text 云盘主页--><!--             a.back-menu-item(href='https://cloud.anzhiy.cn/', rel='external nofollow', title='前往安知鱼云盘', target='_blank', one-link-mark='yes')--><!--               img.back-menu-item-icon(src='https://img02.anzhiy.cn/adminuploads/1/2022/04/27/6268e7d9de532.png')--><!--               span.back-menu-item-text 安知鱼云盘--><!--         .back-menu-list-group--><!--           .back-menu-list-title 项目--><!--           .back-menu-list--><!--             a.back-menu-item(href='http://blgou.net/#/main/home', title='查看德信官网', target='_blank', rel='noopener nofollow', one-link-mark='yes')--><!--               img.back-menu-item-icon(src='https://img02.anzhiy.cn/adminuploads/1/2022/09/15/6322cd942dbd9.png')--><!--               span.back-menu-item-text 德信官网--><!----><!--     a#site-name(href=url_for('/'))--><!--       .title #[=config.title]--><!--       i.fa-solid.fa-house--><!----><!--   div.mask-name-container--><!--     center(id="name-container")--><!--       a(id="page-name" href="javascript:btf.scrollToDest(0, 500)") PAGE_NAME--><!----><!--   #menus--><!--     if (theme.algolia_search.enable || theme.local_search.enable)--><!--       div.nav-button#search-button--><!--         a.site-page.social-icon.search--><!--           i.fas.fa-search.fa-fw--><!--           span=' '+_p('search.title')--><!----><!--     if darkmode.enable && darkmode.button--><!--       div.nav-button#darkmode_navswitch--><!--         a.darkmode_switchbutton(type="button" title=_p('rightside.night_mode_title') onclick="rmf.switchDarkMode()")--><!--           i.fas.fa-adjust--><!----><!--     div.nav-button#nav-totop--><!--       a.totopbtn--><!--         i.fas.fa-arrow-up--><!--         span#percent(onclick="btf.scrollToDest(0,500)") 0--><!----><!----><!--     !=partial('includes/header/menu_item', {}, {cache: true})--><!----><!--     #toggle-menu--><!--       a.site-page--><!--         i.fas.fa-bars.fa-fw--><nav id="nav"><span id="blog_name"><div class="back-home-button" tabindex="-1"><i class="back-home-button-icon fas fa-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="/" title="前往博客主页" target="_blank" one-link-mark="yes"><img class="back-menu-item-icon" src="https://img02.anzhiy.cn/adminuploads/1/2022/09/05/6315ec9737ac4.png"/><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" href="https://www.cloud.anzhiy.cn/" rel="external nofollow" title="前往云盘主页" target="_blank" one-link-mark="yes"><img class="back-menu-item-icon" src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/63232b7d91d22.jpg"/><span class="back-menu-item-text">云盘主页</span></a><a class="back-menu-item" href="https://cloud.anzhiy.cn/" rel="external nofollow" title="前往安知鱼云盘" target="_blank" one-link-mark="yes"><img class="back-menu-item-icon" src="https://img02.anzhiy.cn/adminuploads/1/2022/04/27/6268e7d9de532.png"/><span class="back-menu-item-text">安知鱼云盘</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" href="http://blgou.net/#/main/home" title="查看德信官网" target="_blank" rel="noopener nofollow" one-link-mark="yes"><img class="back-menu-item-icon" src="https://img02.anzhiy.cn/adminuploads/1/2022/09/15/6322cd942dbd9.png"/><span class="back-menu-item-text">德信官网</span></a></div></div></div></div><a id="site-name" href="/"><div class="title">LibertySea</div><i class="fa-solid fa-house"></i></a></span><div class="mask-name-container"><center id="name-container"><a id="page-name" href="javascript:rmf.scrollToTop()">PAGE_NAME</a></center></div><div id="menus"><div class="nav-button" id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="nav-button" id="darkmode_navswitch"><a class="darkmode_switchbutton" type="button" title="浅色和深色模式转换" onclick="rmf.switchDarkMode()"><i class="fas fa-adjust"></i></a></div><div class="nav-button" id="nav-totop"><a class="totopbtn"><i class="fas fa-arrow-up"></i><span id="percent" onclick="btf.scrollToDest(0,500)">0</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-chuansong"></use></svg><span> 文章</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-annual-report"></use></svg><span> 归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tag"></use></svg><span> 标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan4"></use></svg><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:randomPost();"><span> 随机访问</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-chuansong"></use></svg><span> 我的</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/Gallery/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan6"></use></svg><span> 相册</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/source/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-feiyuguantou"></use></svg><span> 资源库</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-kafei"></use></svg><span> 社交</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-shejiaotubiao-38"></use></svg><span> 即刻</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-liuyanban"></use></svg><span> 留言板</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-ziyuan10"></use></svg><span> 友人帐</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-feiji1"></use></svg><span> 关于</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/echarts/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon--tongjibiao"></use></svg><span> 统计</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/me/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-tilamisu"></use></svg><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/essaay/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-baomihua"></use></svg><span> 闲言碎语</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">hadoop总结及词频统计进阶</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-01-13T13:13:48.000Z" title="发表于 2023-01-13 21:13:48">2023-01-13</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-02-06T14:21:45.520Z" title="更新于 2023-02-06 22:21:45">2023-02-06</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/">计算机科学</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/">hadoop</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>24分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="hadoop总结及词频统计进阶"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="post-content" id="article-container"><hr>
<h1 id="提醒"><a href="#提醒" class="headerlink" title="提醒"></a>提醒</h1><p>本文来自博主期末课程论文<br>如对文中数据及代码有所需要,可联系博主获取<br>:::danger<br>文章的引用,必须联系博主获取权限<br>:::</p>
<h1 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h1><p>随着互联网的出现和通信技术的不断进步，数据的产生和传播速度以及数据的传播范围迅速增加，并且数据呈现爆炸性增长。大数据（big data）一词越来越多地被提及，人们用它来描述和定义信息爆炸时代产生的海量数据，并命名与之相关的技术发展与创新。<br>大数据同过去海量数据有所区别，其基本特征可以用“4V”来总结：数据量大（Volume）、数据类型繁多（Variety）、处理速度快（Velocity）、价值密度低（Value）。近年来，数据量的爆炸增长使传统数据仓库无法满足海量数据的存储、处理、挖掘等需求。大数据技术是指从各种各样类型的巨量数据中，快速获得有价值信息的技术。解决大数据问题的核心是大数据技术。<br>如何高效地存储海量数据，如何去分析、计算海量数据，成为大数据时代带来的严峻挑战。大数据处理需要解决的关键性问题，包括数据采集与数据管理、分布式存储和并行计算、大数据应用开发、数据分析与挖掘、大数据前端应用、数据服务和展现等，而这些问题在Hadoop框架下，基本都能够有相应的解决方案。<br>就像Teradata、Oracle、MySQL是传统数据仓库的实现工具一样，Hadoop也是大数据的实现方式。大数据与数据仓库一样，都是一种数据存储与处理的概念。但是Hadoop是真正实现大数据理念的工具。它是实际的代码与软件，实现了大数据传达的海量数据低成本存储，快速数据处理的理念。<br>Hadoop就是一个开源分布式计算平台。它的核心是分布式文件系统（HDFS）和分布式计算框架（MapReduce），它采用HDFS来提高读写速度和扩大存储容量；采用MapReduce整合分布式文件系统上的数据，保证高速分析处理数据；与此同时还采用存储冗余数据来保证数据的安全性。作为一种比较成熟且主流的大数据开发工具，Hadoop正在以它强大的生态为数据时代创造价值。</p>
<h1 id="大数据概述"><a href="#大数据概述" class="headerlink" title="大数据概述"></a>大数据概述</h1><p>第三次信息化浪潮涌动，大数据时代全面开启。人类社会信息科技的发展为大数据时代的到来提供了技术支撑，而数据产生方式的变革是促进大数据时代到来至关重要的因素。数据的爆炸性增长态势、数据构成的特点使得人类社会进入了“大数据”时代。<br>与传统数据相比，大数据具有数据量大（Volume）、数据类型繁多（Variety）、处理速度快（Velocity）、价值密度低（Value）的特征。随着数据的爆炸性增长，基于4V特征，计算机将不仅仅能做模拟仿真，还能进行分析总结，得到理论。数据密集范式从第三范式中分离出来，成为一个独特的科学研究范式，这种科学研究的方式，被称为第四范式：数据密集型科学。数据密集型科学由传统的假设驱动向基于科学数据进行探索的科学方法的转变。根据大数据和传统数据的特征，在处理这些海量数据时，我们的思维应有所变化：全量而不是抽样，效率而不是精度，相关性因果关系。大数据时最大的转变就是放弃了对因果关系的渴求转而关注相关关系。关联关系是大数据的本质特征之一。大数据时代解决问题的方式，即基于海量数据，利用计算机发掘相关性进而把握事物发展的轨迹，实现科学预测解决问题。<br>在过去认为非常难以解决的智能问题，会因大数据的使用迎刃而解。大数据还会彻底改变未来的商业模式，很多传统的行业都将采用数据驱动的智能技术实现升级换代，同时改变原有的商业模式。电商方面：精准广告位，通过对用户的浏览行为，点击行为等进行大数据采集，分析，挖掘用户的二层三层喜欢，扩大产出。传媒方面：猜你喜欢，通过对受众人群机型大数据分析，结合对应算法，对受众喜欢的进行交互推荐。金融方面：理财投资，通过对个人的信用评估，风险承担能力评估，集合众多理财产品、推荐响应的投资理财产品。安防方面：人脸识别，通过人脸识别，匹配，存储用户数据，结合人工智能，分析及甄别用户行为，预防犯罪行为发生。医疗方面：智慧医疗，通过对海量病例大数据的存储，匹配、检索、结合用户的饮食、行为等习惯，搭建智慧医疗体系。大数据在金融、汽车、零售、餐饮、电信、能源、政务、医疗、体育、娱乐等在内的社会各行各业都得到了日益广泛的应用，深刻地改变着我们的社会生产和日常生活。<br>在技术层面，大数据的关键技术包括数据采集与预处理、数据存储和管理、数据处理和分析、数据安全、隐患和保护。两大核心技术是分布式存储和分布式处理。在这些技术下产业层次愈发清晰，IT基础设施层、数据源层、数据管理层、数据分析层、数据平台层和数据应⽤层，在不同层⾯，都已经形成了⼀批引领市场的技术和企业。<br>云计算、⼤数据和物联⽹一直为人们所热议，他们代表了IT领域最新的技术发展趋势，三者相辅相成，既有联系⼜有区别。云计算为大数据提供技术基础的同时大数据也为云计算提供用武之地；云计算为物联网提供海量的数据，作为数据的提供商。物联网也为云计算提供无边无际广阔的空间；大数据为物联网提供数据分析的支持，物联网是大数据的重要来源。</p>
<h1 id="大数据处理架构Hadoop"><a href="#大数据处理架构Hadoop" class="headerlink" title="大数据处理架构Hadoop"></a>大数据处理架构Hadoop</h1><p>Hadoop是Apache软件基金会旗下的一个开源分布式计算平台。利用Hadoop，用户可以在不了解分布式底层细节的情况下，开发分布式程序。充分利用集群的计算和存储能力，完成海量数据的处理。<br>Hadoop是Apache Lucene创始人Doug Cutting 创建的。最早起源于Nutch，它是Lucene的子项目。Nutch的设计目标是构建一个大型的全网搜索引擎，包括网页抓取、索引、查询等功能，但随着抓取网页数量的增加，遇到了严重的可扩展性问题：如何解决数十亿网页的存储和索引问题。在2003至2004年，Google陆续公布了部分GFS和MapReduce思想的细节，Nutch的创始人Doug Cutting受到启发，用了若干年时间实现了DFS和MapReduce机制，使Nutch性能飙升。2005年，Hadoop作为Lucene子项目Nutch的一部分正式被引入Apache基金会，随后又从Nutch中剥离，成为一套完整独立的软件，起名为Hadoop。2006年Google发表了关于BigTable的论文，这促使了后来的Hbase的发展。Hadoop就是以GFS、MapReduce和BigTable这三篇论文为基础研发的，可以说Google是Hadoop的思想之源，Hadoop也因此被称为是Google计算的山寨版，但由于它是世界上唯一一个做得相对完善而又开源的框架，这种“山寨版”却成了当下大数据处理技术的国际标准。<br>Hadoop具有高可靠性、高效性、高可扩展性、高容错性、低成本、运行在Linux平台、支持多种编程语言等优良特性。凭借其突出优势，Hadoop已经在各个领域得到了广泛应用，雅虎、Facebook、百度、淘宝、网易等公司都建立了自己的Hadoop集群。<br>关于Hadoop的演变，在Hadoop1.x时代，Hadoop中的MapReduce同时处理业务逻辑运算和资源的调度，耦合性较大；在Hadoop2.x时代，Hadoop架构产生重大变化，引入了YARN平台等许多新特性，YARN负责资源的调度，MapReduce只负责运算；在Hadoop3.x时代，对HDFS、MapReduce、YARN都有较大升级，还新增了Ozone key-value存储，在组成上没有变化。<br><img src="/2023-01-13-21-19-17.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSKzKOO"><img src="https://s1.ax1x.com/2023/01/13/pSKzKOO.png" alt="pSKzKOO.png"></a></p>
<p>随着处理任务不同，各组件相继出现，经过多年的发展，Hadoop已形成了一个相当成熟的生态系统。<br><img src="/2023-01-13-21-20-17.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSKz1TH"><img src="https://s1.ax1x.com/2023/01/13/pSKz1TH.png" alt="pSKz1TH.png"></a></p>
<p><img src="/2023-01-13-21-20-49.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSKzJfI"><img src="https://s1.ax1x.com/2023/01/13/pSKzJfI.png" alt="pSKzJfI.png"></a></p>
<h1 id="分布式文件系统HDFS"><a href="#分布式文件系统HDFS" class="headerlink" title="分布式文件系统HDFS"></a>分布式文件系统HDFS</h1><p>HDFS全称Hadoop Distributed File System,是一个分布式文件系统。HDFS 有着高容错性，被设计用来部署在低廉的硬件上来提供高吞吐量的访问应用程序的数据，适合超大数据集的应用程序。<br>HDFS是以分布式进行存储的文件系统，主要负责集群数据的存储与读取。分布式系统可以划分成多个子系统或模块，各自运行在不同的机器上，子系统或模块之间通过网络通信进行协作，以实现最终的整体功能。利用多个节点共同协作完成一项或多项具体业务功能的系统即为分布式系统。<br>HDFS作为一个分布式文件系统，其分布式主要体现在如下3个方面。<br>1）HDFS并不是一个单机文件系统，而是分布在多个集群节点上的文件系统。节点之间通过网络通信进行协作，提供多个节点的文件信息，使每个用户均可以看到文件系统的文件，使多台机器上的多用户可以分享文件和存储空间。<br>2）当存储文件时，文件的数据将分布在多个节点上。数据存储不是按一个文件存储，而是将一个文件分成一个或多个数据块进行存储。数据块在存储时并不是都存储在一个节点上，而是被分别存储在各个节点中，并且数据块会在其他节点存储副本。<br>3）数据从多个节点读取。读取一个文件时，从多个节点中找到该文件的数据块，分别读取所有数据块，直至最后一个数据块读取完毕。<br>HDFS是一个主&#x2F;从（Master&#x2F;Slave）体系架构的分布式文件系统。HDFS支持传统的层次型文件组织结构，使得用户或应用程序可以创建目录，再将文件保存至目录中。文件系统命名空间的层次结构和大多数现有的文件系统类似，可以通过文件路径对文件执行创建、读取、更新和删除操作。<br><img src="/2023-01-13-21-21-46.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSKzN1P"><img src="https://s1.ax1x.com/2023/01/13/pSKzN1P.png" alt="pSKzN1P.png"></a></p>
<p>HDFS文件系统主要包含一个NameNode、一个Secondary NameNode和多个DataNode。<br>（1）NameNode<br>NameNode用于存储元数据以及处理客户端发出的请求。元数据不是具体的文件内容，它包含3类重要信息。第1类信息是文件和目录自身的属性信息，如文件名、目录名、父目录信息、文件大小、创建时间、修改时间等；第2类信息是记录文件内容存储的相关信息，如文件分块情况、副本个数、每个副本所在的DataNode信息等；第3类信息是用于记录HDFS中所有DataNode的信息，用于DataNode管理。<br>在NameNode中存放元信息的文件是fsimage文件。在系统运行期间，所有对元数据的操作均保存在内存中，并被持久化到另一个文件edits中。当NameNode启动时，fsimage文件将被加载至内存，再对内存里的数据执行edits文件所记录的操作，以确保内存所保留的数据处于最新的状态。<br>（2）Secondary NameNode<br>Secondary NameNode用于备份NameNode的数据，周期性地将edits文件合并到fsimage文件并在本地备份，然后将新的fsimage文件存储至NameNode，覆盖原有的fsimage文件，删除edits文件，并创建一个新的edits文件继续存储文件当前的修改状态。<br>（3）DataNode<br>DataNode是真正存储数据的地方。在DataNode中，文件以数据块的形式进行存储。Hadoop 3.x默认128 MB为一个数据块，如果存储一个大小为129 MB的文件，那么文件将被分为两个数据块进行存储。当文件上传至HDFS端时，HDFS会将文件按128MB的数据块大小进行切割，将每个数据块存储至不同的或相同的DataNode并备份副本，一般默认备份3个副本。NameNode负责记录文件的分块信息，以确保在读取该文件时可以找到并整合所有数据块。<br>随着数据量越来越多，传统的单机式文件存储系统已经不能满足日益增长的数据存储需求，分布式文件存储系统—HDFS应运而生。作为分布式文件系统，HDFS能够解决海量数据的存储问题，其优点列举如下。<br>1）高容错性。HDFS上传的数据会自动保存多个副本，通过增加副本的数量增加HDFS的容错性。如果某一个副本丢失，那么HDFS将复制其他节点上的副本。<br>2）适合大规模数据的处理。HDFS能够处理GB、TB甚至PB级别的数据，数量级规模可达百万，数量非常大。<br>3）流式数据访问。HDFS以流式数据访问模式存储超大文件，有着“一次写入，多次读取”的特点，且文件一旦写入，不能修改，只能增加，以保证数据的一致性。<br>当然HDFS也不是完美的，同样存在局限性，如不适合低延迟数据访问，无法高效存储大量小文件、不支持多用户写入及任意修改文件。</p>
<h1 id="分布式计算框架MapReduce"><a href="#分布式计算框架MapReduce" class="headerlink" title="分布式计算框架MapReduce"></a>分布式计算框架MapReduce</h1><p>MapReduce是一个分布式运算程序的编程框架，是基于Hadoop的数据分析应用的核心框架。MapReduce的核心功能是将用户编写的业务逻辑代码和自带的组件整合成一个完整的分布式运算程序，并行运行在Hadoop集群上。认识MapReduce分布式计算框架，并了解MapReduce的执行流程，有利于后续的MapReduce编程学习。<br>MapReduce是Hadoop的核心计算框架，是用于大规模数据集（大于1TB）并行运算的编程模型，主要包括Map（映射）和Reduce（规约）两个阶段。<br>1）当启动一个MapReduce任务时，Map端将会读取HDFS上的数据，将数据映射成所需要的键值对类型并传至Reduce端。<br>2）Reduce端接收Map端键值对类型的中间数据，并根据不同键进行分组，对每一组键相同的数据进行处理，得到新的键值对并输出至HDFS。</p>
<p><img src="/2023-01-13-21-23-04.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSKzaX8"><img src="https://s1.ax1x.com/2023/01/13/pSKzaX8.png" alt="pSKzaX8.png"></a></p>
<p>一个完整的MapReduce过程涉及数据的输入与分片、Map阶段数据处理、Shuffle&amp;Sort阶段数据整合、Reduce阶段数据处理、数据输出等操作。<br>1）数据的输入与分片。MapReduce过程中的数据是从HDFS分布式文件系统中读取的。文件上传至HDFS时，一般按照128 MB分成若干个数据块，所以在运行MapReduce程序时，每个数据块均会对应一个Map任务。也可以通过重新设置文件分片大小调整Map的个数，在运行MapReduce程序时系统会根据所设置的分片大小对文件重新分片（Split）。<br>2）Map阶段数据处理。一个程序有一个或多个Map任务，具体由默认存储或分片个数决定。在Map阶段，数据将以键值对的形式被读入，键的值一般为每行首字符与文件最初始位置的偏移量，即中间所隔字符个数，值为该行的数据记录。根据具体的需求对键值对进行处理，映射成新的键值对并传输至Reduce端。<br>3）Shuffle&amp;Sort阶段数据整合。此阶段是指从Map端输出开始，传输至Reduce端之前的过程。该过程会对同一个Map中输出的键相同的数据先进行整合，减少传输的数据量，并在整合后将数据按照键进行排序。<br>4）Reduce阶段数据处理。Reduce任务可以有一个或多个，具体由Map阶段设置的数据分区确定，一个分区数据将被一个Reduce处理。针对每一个Reduce任务，Reduce会接收到不同Map任务传来的数据，并且每个Map传来的数据都是有序的。一个Reduce任务中的每一次处理均是针对所有键相同的数据，对数据进行规约，形成新的键值对。<br>5）数据输出。Reduce阶段处理完数据后即可将数据文件输出至HDFS，输出的文件个数和Reduce的个数一致。如果只有一个Reduce，那么输出只有一个数据文件，默认命名为“part-r-00000”。</p>
<h1 id="词频统计及进阶"><a href="#词频统计及进阶" class="headerlink" title="词频统计及进阶"></a>词频统计及进阶</h1><h2 id="程序任务"><a href="#程序任务" class="headerlink" title="程序任务"></a>程序任务</h2><p>对英文名著数据集进行词频统计,利用停用词表过滤掉停用词,利用统计结果按照词频降序排序,词频相同的词按照字典序排序。</p>
<h2 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h2><p>（1）收集数据，对数据进行预处理，去除其中的标点符号。<br>（2）对WordCount进行改进，增加停用词表、大小写转化、降频排序等功能。<br>（3）对统计结果进行数据可视化处理。</p>
<h2 id="数据收集"><a href="#数据收集" class="headerlink" title="数据收集"></a>数据收集</h2><p>数据来源于网络采集，共21篇英文名著，分别存储在txt文件中，初始形式如下。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A Blot In The <span class="string">&#x27;Scutcheon</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">by Robert Browning</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">INTRODUCTORY NOTE</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">ROBERT BROWNING stands, in respect to his origin and his career, in marked contrast to the two aristocratic poets beside whose dramas his &quot;Blot in the &#x27;</span>Scutcheon<span class="string">&quot; is here printed.  His father was a bank clerk and a dissenter at a time when dissent meant exclusion from Society; the poet went neither to one of the great public schools nor to Oxford or Cambridge; and no breath of scandal touched his name. Born in London in 1812, he was educated largely by private tutors, and spent two years at London University, but the influence of his father, a man of wide reading and cultivated tastes, was probably the most important element in his early training.  He drew well, was something of a musician, and wrote verses from an early age, though it was the accidental reading of a volume of Shelley which first kindled his real inspiration.  This indebtedness is beautifully acknowledged in his first published poem, &quot;</span>Pauline<span class="string">&quot; (1833).</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>

<h2 id="数据预处理"><a href="#数据预处理" class="headerlink" title="数据预处理"></a>数据预处理</h2><p>利用Python第三方库nltk中的word_tokenize将英文单词提取出来，达到去除标点的效果。代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> nltk.tokenize <span class="keyword">import</span> word_tokenize</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clean_non_english</span>(<span class="params">txt</span>): <span class="comment"># 提取英文单词,去除标点</span></span><br><span class="line">    txt = txt.strip()</span><br><span class="line">    txt = re.sub(<span class="string">r&#x27;\W+&#x27;</span>, <span class="string">&#x27; &#x27;</span>, txt)</span><br><span class="line">    txt = txt.replace(<span class="string">&quot;[^a-zA-Z]&quot;</span>, <span class="string">&quot; &quot;</span>)</span><br><span class="line">    word_tokens = word_tokenize(txt)</span><br><span class="line">    filtered_word = [w <span class="keyword">for</span> w <span class="keyword">in</span> word_tokens <span class="keyword">if</span> <span class="built_in">all</span>(<span class="built_in">ord</span>(c) &lt; <span class="number">128</span> <span class="keyword">for</span> c <span class="keyword">in</span> w)]</span><br><span class="line">    filtered_word = [w + <span class="string">&quot; &quot;</span> <span class="keyword">for</span> w <span class="keyword">in</span> filtered_word]</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(filtered_word)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_txt</span>(<span class="params">r_file</span>):  <span class="comment"># 读取文件</span></span><br><span class="line">    <span class="built_in">str</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(r_file, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;gbk&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">            line = line.strip(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">            <span class="built_in">str</span> = <span class="built_in">str</span> + line</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_txt</span>(<span class="params">w_file, <span class="built_in">str</span></span>):  <span class="comment"># 写入文件</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(w_file, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> r:</span><br><span class="line">        r.write(<span class="built_in">str</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">20</span>):</span><br><span class="line">    <span class="built_in">str</span> = read_txt(<span class="string">&quot;D:/SCSMIS/com/www/wzh/data/%s.txt&quot;</span> % i)</span><br><span class="line">    <span class="built_in">str</span> = <span class="built_in">str</span>.replace(<span class="string">&quot;_&quot;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">str</span> = clean_non_english(<span class="built_in">str</span>)</span><br><span class="line">    write_txt(<span class="string">&#x27;D:/SCSMIS/com/www/wzh/r_data/r_%s.txt&#x27;</span> % i, <span class="built_in">str</span>)</span><br></pre></td></tr></table></figure>

<p>处理后结果形式</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">A Blot In The Scutcheonby Robert BrowningINTRODUCTORY NOTEROBERT BROWNING stands <span class="keyword">in</span> respect to his origin and his career <span class="keyword">in</span> marked contrast to the two aristocratic poets beside whose dramas his Blot <span class="keyword">in</span> the Scutcheon is here printed His father was a bank clerk and a dissenter at a time when dissent meant exclusion from Society the poet went neither to one of the great public schools nor to Oxford or Cambridge and no breath of scandal touched his name Born <span class="keyword">in</span> London <span class="keyword">in</span> 1812 he was educated largely by private tutors and spent two years at London University but the influence of his father a man of wide reading and cultivated tastes was probably the most important element <span class="keyword">in</span> his early training He drew well was something of a musician and wrote verses from an early age though it was the accidental reading of a volume of Shelley <span class="built_in">which</span> first kindled his real inspiration This indebtedness is beautifully acknowledged <span class="keyword">in</span> his first published poem Pauline 1833 Apart from frequent visits to Italy there is little of incident to chronicle <span class="keyword">in</span> Browning s life with the one great exception of his more than fortunate marriage <span class="keyword">in</span> 1846 to Elizabeth Barrett the greatest of English poetesses Browning s dramatic period extended from 1835 to the time of his marriage and produced some nine plays not all of <span class="built_in">which</span> however were intended <span class="keyword">for</span> the stage Paracelsus the first of the series has been fairly described as a conversational drama and Pippa Passes though it has been staged is essentially a </span><br></pre></td></tr></table></figure>

<h2 id="词频统计"><a href="#词频统计" class="headerlink" title="词频统计"></a>词频统计</h2><p>在词频统计中，需要实现词频统计和降频排序两个任务，根据任务划分为两个job。<br>任务一，词频统计并实现停用词表。<br>在map阶段，要判断所接收的词是否是停用词，不是则输出。<br>停用词表在任务一开始时就被读取，需将其设为全局变量。<br>在main函数里的第一个job中加入缓存文件停用词表stopwords.txt</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 任务1：词频统计</span></span><br><span class="line">        <span class="type">Job</span> <span class="variable">job</span> <span class="operator">=</span> Job.getInstance(conf, <span class="string">&quot;word count&quot;</span>);</span><br><span class="line">        <span class="comment">// 读取停用词表</span></span><br><span class="line">        job.addCacheFile(<span class="keyword">new</span> <span class="title class_">URI</span>(<span class="string">&quot;hdfs://localhost:9000/user/wzh/input/stopwords/stopwords.txt&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>在Mapper中的设置一个空列表li，在Mapper中的setup阶段读缓存文件，将其中的每一个停用词加入到列表中。<br>在map阶段，以空格为分隔符，读取英文名著集，如果不在停用词表中，将单词转换为小写，输出&lt;key&#x3D;词，value&#x3D;词频1&gt;。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TokenizerMapper</span> <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;Object, Text, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">IntWritable</span> <span class="variable">one</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Text</span> <span class="variable">word</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> List&lt;String&gt; li = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;String&gt;();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">setup</span><span class="params">(Context context)</span><span class="keyword">throws</span> IOException, InterruptedException &#123;<span class="comment">//获取缓存文件路径的数组</span></span><br><span class="line">        Path [] paths = DistributedCache.getLocalCacheFiles(context.getConfiguration());</span><br><span class="line">        System.out.println(paths);</span><br><span class="line">        <span class="type">BufferedReader</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BufferedReader</span>(<span class="keyword">new</span> <span class="title class_">FileReader</span>(paths[<span class="number">0</span>].toUri().getPath()));</span><br><span class="line">        <span class="comment">//读取BufferedReader里面的数据</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">tmp</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">while</span> ( (tmp = sb.readLine()) != <span class="literal">null</span>) &#123;</span><br><span class="line">            String ss []= tmp.split(<span class="string">&quot; &quot;</span>);</span><br><span class="line">            <span class="keyword">for</span> (String s : ss) &#123;</span><br><span class="line">                li.add(s);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        sb.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TokenizerMapper</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(Object key, Text value, Mapper&lt;Object, Text, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">StringTokenizer</span> <span class="variable">itr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>(value.toString());</span><br><span class="line">        <span class="keyword">while</span>(itr.hasMoreTokens()) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">tmpword</span> <span class="operator">=</span> itr.nextToken();</span><br><span class="line">            <span class="comment">// 将英文名著按行读取，使用空格分割成一个个词，将词化为小写，如果词不在停用词列表中，输出。</span></span><br><span class="line">            <span class="keyword">if</span> (!li.contains(tmpword.toLowerCase()))&#123;</span><br><span class="line">                word.set(tmpword.toLowerCase()); <span class="comment">// 将单词转换为小写</span></span><br><span class="line">                context.write(<span class="built_in">this</span>.word, one);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Reducer收到词，将key即相同的词merge合并累计词频。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">IntSumReducer</span> <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;Text, IntWritable, Text, IntWritable&gt; &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">IntSumReducer</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(Text key, Iterable&lt;IntWritable&gt; values, Reducer&lt;Text, IntWritable, Text, IntWritable&gt;.Context context)</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        IntWritable val;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">Iterator</span> <span class="variable">i$</span> <span class="operator">=</span> values.iterator(); i$.hasNext(); sum += val.get()) &#123;</span><br><span class="line">            val = (IntWritable)i$.next();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">this</span>.result.set(sum);</span><br><span class="line">        context.write(key, <span class="built_in">this</span>.result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>任务二，降频排序。<br>排序原则：自定义排序，按词频降序，词频相同按照词的字典序排序。<br>由于MapReduce是根据key来排序，所以要自定义key的数据类型从而自定义排序方式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> x;</span><br><span class="line"><span class="keyword">public</span> String y;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getX</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">getY</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readFields</span><span class="params">(DataInput in)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    x = in.readInt();</span><br><span class="line">    y = in.readUTF();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">write</span><span class="params">(DataOutput out)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    out.writeInt(x);</span><br><span class="line">    out.writeUTF(y);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>自定义了数据类型myclass，其中两个变量x代表词频，y代表词。排序方式定义为按词频降序，词频相同按照词的字典序排序。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compareTo</span><span class="params">(myclass p)</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">this</span>.x &gt; p.x) &#123;</span><br><span class="line">                <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.x &lt; p.x) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">this</span>.getY().compareTo(p.getY()) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">this</span>.getY().compareTo(p.getY()) &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>Mapper中读取词和词频，构造输出&lt;key，value&gt;为类型为myclass，IntWritable。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">TokenizerMapper1</span></span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">Mapper</span>&lt;Object, Text, myclass, IntWritable&gt;&#123;</span><br><span class="line">    <span class="comment">//private Text keyInfo = new Text();</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">valueInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">map</span><span class="params">(Object key, Text value, Context context</span></span><br><span class="line"><span class="params">    )</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        <span class="type">StringTokenizer</span> <span class="variable">itr</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringTokenizer</span>( value.toString());</span><br><span class="line">        String[] word = value.toString().split(<span class="string">&quot;\\s+&quot;</span>);</span><br><span class="line">        <span class="type">myclass</span> <span class="variable">keyInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">myclass</span>();</span><br><span class="line">        keyInfo.x=Integer.parseInt(word[word.length-<span class="number">1</span>]);</span><br><span class="line">        keyInfo.y=word[word.length-<span class="number">2</span>];</span><br><span class="line">        valueInfo.set(Integer.parseInt(word[word.length-<span class="number">1</span>]));</span><br><span class="line">        context.write(keyInfo, valueInfo);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Reducer把输出的key再改回词</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">IntSumReducer1</span></span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">Reducer</span>&lt;myclass,IntWritable,Text,IntWritable&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">IntWritable</span> <span class="variable">valueInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">IntWritable</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Text</span> <span class="variable">keyInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Text</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">reduce</span><span class="params">(myclass key, Iterable&lt;IntWritable&gt; values,</span></span><br><span class="line"><span class="params">                       Context context</span></span><br><span class="line"><span class="params">    )</span> <span class="keyword">throws</span> IOException, InterruptedException &#123;</span><br><span class="line">        keyInfo.set(key.y);</span><br><span class="line">        valueInfo.set(key.x);</span><br><span class="line">        context.write(keyInfo, valueInfo);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="数据可视化"><a href="#数据可视化" class="headerlink" title="数据可视化"></a>数据可视化</h2><p>利用Python的第三方库matplotlib和wordcloud进行数据可视化，绘制词云图和条形图。词云图选用统计次数最多的200个单词，条形图选用统计次数最多的10个单词。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> wordcloud</span><br><span class="line"></span><br><span class="line">text = <span class="built_in">open</span>(<span class="string">&#x27;D:/SCSMIS/com/www/wzh/part-r-00000.txt&#x27;</span>, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>).read()</span><br><span class="line"></span><br><span class="line">w = wordcloud.WordCloud(background_color=<span class="string">&quot;white&quot;</span>, width=<span class="number">600</span>, height=<span class="number">400</span>)</span><br><span class="line">w.generate(text)</span><br><span class="line">w.to_file(<span class="string">&quot;pywordcloud2.png&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置字体为SimHei显示中文</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line"><span class="comment"># #设置正常显示字符</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">word = [<span class="string">&#x27;god&#x27;</span>, <span class="string">&#x27;death&#x27;</span>, <span class="string">&#x27;heart&#x27;</span>, <span class="string">&#x27;ye&#x27;</span>, <span class="string">&#x27;fathe&#x27;</span>, <span class="string">&#x27;king&#x27;</span>, <span class="string">&#x27;lord&#x27;</span>, <span class="string">&#x27;money&#x27;</span>, <span class="string">&#x27;love&#x27;</span>, <span class="string">&#x27;ellinor&#x27;</span>]</span><br><span class="line">y = np.arange(<span class="number">10</span>)</span><br><span class="line">x = np.array([<span class="number">354</span>, <span class="number">356</span>, <span class="number">403</span>, <span class="number">408</span>, <span class="number">436</span>, <span class="number">449</span>, <span class="number">453</span>, <span class="number">479</span>, <span class="number">497</span>, <span class="number">511</span>])</span><br><span class="line">bar_height = <span class="number">0.3</span></span><br><span class="line">plt.barh(y, x, tick_label=word, height=bar_height, align=<span class="string">&#x27;center&#x27;</span>, color=[<span class="string">&#x27;#FA8072&#x27;</span>])</span><br><span class="line">plt.title(<span class="string">&#x27;高频单词&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;出现次数&#x27;</span>)</span><br><span class="line">plt.savefig(<span class="string">&#x27;D:/SCSMIS/com/www/wzh/barh.jpg&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="运行结果"><a href="#运行结果" class="headerlink" title="运行结果"></a>运行结果</h2><p><img src="/2023-01-14-10-21-43.png"><br><a target="_blank" rel="noopener" href="https://imgse.com/i/pSMMhDg"><img src="https://s1.ax1x.com/2023/01/14/pSMMhDg.png" alt="pSMMhDg.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pSMMfKS"><img src="https://s1.ax1x.com/2023/01/14/pSMMfKS.png" alt="pSMMfKS.png"></a></p>
<p><a target="_blank" rel="noopener" href="https://imgse.com/i/pSMM2gf"><img src="https://s1.ax1x.com/2023/01/14/pSMM2gf.jpg" alt="pSMM2gf.jpg"></a></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Hadoop发展至今日,生态圈已经十分丰富，能够满足不同场景的大数据处理需求，作为目前主流的大数据处理技术，市场上很多公司的大数据业务都是基于Hadoop开展，而且对很多场景已经具有非常成熟的解决方案。掌握Hadoop及其生态内框架的开发技术，就是进入大数据领域的必经之路。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://blog.xiaowang.icu">LibertySea</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://blog.xiaowang.icu/2023/01/13/computer-science/big-data/hadoop/hadoop%E6%80%BB%E7%BB%93%E5%8F%8A%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E8%BF%9B%E9%98%B6/">http://blog.xiaowang.icu/2023/01/13/computer-science/big-data/hadoop/hadoop总结及词频统计进阶/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://blog.xiaowang.icu" target="_blank">LibertySea</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/hadoop/">hadoop</a><a class="post-meta__tags" href="/tags/HDFS/">HDFS</a><a class="post-meta__tags" href="/tags/MapReduce/">MapReduce</a><a class="post-meta__tags" href="/tags/%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1/">词频统计</a></div><div class="post_share"><div class="social-share" data-image="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciundwu5j20zk0m8n9e.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="wechat"/></a><div class="post-qr-code-desc">wechat</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="alipay"/></a><div class="post-qr-code-desc">alipay</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/01/15/computer-science/big-data/Java/JavaIO%E6%B5%81/JavaIO%E6%B5%81/"><img class="prev-cover" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giph4lm9i7j20zk0m84qp.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JavaIO流</div></div></a></div><div class="next-post pull-right"><a href="/2023/01/13/computer-science/deeplearning/%E5%9F%BA%E4%BA%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%B8%AD%E5%8C%BB%E8%8D%AF%E8%AF%86%E5%88%AB%E4%B8%8E%E9%A2%84%E6%B5%8B/%E5%9F%BA%E4%BA%8E%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E4%B8%AD%E5%8C%BB%E8%8D%AF%E8%AF%86%E5%88%AB%E4%B8%8E%E9%A2%84%E6%B5%8B/"><img class="next-cover" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giclhtuo6nj20zk0m8ttm.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">基于深度学习的中医药识别与预测</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="author_top is-center"><div class="card-info-avatar"><div class="avatar-img"><img src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/v2-99baee7dfbc714d5498a770bf3ec6d77_r.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-status-box"><div class="author-status"><g-emoji class="g-emoji" alias="palm_tree" fallback-src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/fe1dc0402e623096.jpg">🐟</g-emoji><span>认真摸鱼中</span></div></div></div><div class="author-info__name">LibertySea</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" href="/me/"><i></i><span>了解更多</span></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/libertysea" target="_blank" title="Github"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-github"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://res.abeim.cn/api/qq/?qq=1378600591" target="_blank" title="QQ"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-QQ"></use></svg></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/431072460" target="_blank" title="B站"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-bilibili"></use></svg></a><a class="social-icon faa-parent animated-hover" href="mailto:1378600591@qq.com" target="_blank" title="QQ邮箱"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-youxiang"></use></svg></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><a class="faa-parent animated-hover"><svg class="faa-tada icon" style="height:25px;width:25px;fill:currentColor;position:relative;top:5px" aria-hidden="true"><use xlink:href="#icon-ziyuan5"></use></svg></a><span>入站必读</span></div><div class="announcement_content"><center>主域名：<br><a target="_blank" rel="noopener" href="https://www.fomal.cc"><b><font color="#5ea6e5">fomal.cc</font></b></a>&nbsp;|&nbsp;<a target="_blank" rel="noopener" href="https://www.fomal.cn"><b><font color="#5ea6e5">fomal.cn</font></b></a><br>备用域名：<br><a target="_blank" rel="noopener" href="https://blog.fomal.cc"><b><font color="#5ea6e5">blog.fomal.cc</font></b></a><br><a target="_blank" rel="noopener" href="https://aa.fomal.cc"><b><font color="#5ea6e5">aa.fomal.cc</font></b></a><br><a target="_blank" rel="noopener" href="https://bb.fomal.cc"><b><font color="#5ea6e5">bb.fomal.cc</font></b></a><br><a href="mailto:admin@fomal.cn">📬：<b><font color="#a591e0">admin@fomal.cn</font></b></a></center></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8F%90%E9%86%92"><span class="toc-number">1.</span> <span class="toc-text">提醒</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-number">2.</span> <span class="toc-text">引言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%A6%82%E8%BF%B0"><span class="toc-number">3.</span> <span class="toc-text">大数据概述</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%9E%B6%E6%9E%84Hadoop"><span class="toc-number">4.</span> <span class="toc-text">大数据处理架构Hadoop</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9FHDFS"><span class="toc-number">5.</span> <span class="toc-text">分布式文件系统HDFS</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6MapReduce"><span class="toc-number">6.</span> <span class="toc-text">分布式计算框架MapReduce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E5%8F%8A%E8%BF%9B%E9%98%B6"><span class="toc-number">7.</span> <span class="toc-text">词频统计及进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E4%BB%BB%E5%8A%A1"><span class="toc-number">7.1.</span> <span class="toc-text">程序任务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">7.2.</span> <span class="toc-text">设计思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86"><span class="toc-number">7.3.</span> <span class="toc-text">数据收集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86"><span class="toc-number">7.4.</span> <span class="toc-text">数据预处理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1"><span class="toc-number">7.5.</span> <span class="toc-text">词频统计</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96"><span class="toc-number">7.6.</span> <span class="toc-text">数据可视化</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="toc-number">7.7.</span> <span class="toc-text">运行结果</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div></div></main><footer id="footer"><!--#footer_deal--><!--  a.deal_link(href="mailto:1378600591@qq.com" title="mail")--><!--    i.iconfont.icon-youxiang--><!--  a.deal_link(href="https://res.abeim.cn/api/qq/?qq=1378600591" title="qq" target="_blank")--><!--    i.iconfont.icon-QQ--><!--  img.footer_mini_logo.entered.loading(style="border-radius:50%" src='https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/v2-99baee7dfbc714d5498a770bf3ec6d77_r.jpg' onclick="btf.scrollToDest(0,500)" title="返回顶部")--><!--  a.deal_link(href="https://space.bilibili.com/431072460" title="bilibili")--><!--    i.iconfont.icon-bilibili--><!--  a.deal_link(href="https://github.com/libertysea" title="github"  target="_blank")--><!--    i.iconfont.icon-github--><div id="footer-banner"><div class="footer-banner-links"><div class="footer-banner-left"><div class="footer-banner-left"><div id="footer-banner-tips"></div><script src="https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js"></script><script>var typed = new Typed("#footer-banner-tips", {
  strings: ["念念不忘，必有回响。", "Never forget, there will be echoes."],
  startDelay: 200,
  backDelay: 2000,
  typeSpeed: 100,
  loop: true,
  backSpeed: 20
})
</script></div></div><div class="footer-banner-right"><a class="footer-banner-link" target="_blank" rel="noopener" href="https://hexo.io/zh-cn/" title="Hexo">框架</a><a class="footer-banner-link">|</a><a class="footer-banner-link" target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly" title="theme">主题</a><a class="footer-banner-link">|</a><a class="footer-banner-link" href="/atom.xml" title="RSS">订阅</a><a class="footer-banner-link">|</a><a class="footer-banner-link" href="/about/" title="about">关于</a><a class="footer-banner-link">|</a><a class="footer-banner-link cc" href="/cc/" title="cc协议"><i class="iconfont icon-cc"></i><span>协议</span></a></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><a class="icon-V hidden" onclick="switchNightMode()" title="浅色和深色模式转换"><svg width="25" height="25" viewBox="0 0 1024 1024"><use id="modeicon" xlink:href="#icon-moon"></use></svg></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="share" type="button" title="分享链接" onclick="share()"><i class="fas fa-share-nodes"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent"><span>0</span><span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div class="js-pjax" id="rightMenu"><div class="rightMenu-group rightMenu-small"><a class="rightMenu-item" href="javascript:window.history.back();"><i class="fa fa-arrow-left"></i></a><a class="rightMenu-item" href="javascript:window.history.forward();"><i class="fa fa-arrow-right"></i></a><a class="rightMenu-item" href="javascript:window.location.reload();"><i class="fa fa-refresh"></i></a><a class="rightMenu-item" href="javascript:rmf.scrollToTop();"><i class="fa fa-arrow-up"></i></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-text"><a class="rightMenu-item" href="javascript:rmf.copySelect();"><i class="fa fa-copy"></i><span>复制</span></a><a class="rightMenu-item" href="javascript:window.open(&quot;https://www.baidu.com/s?wd=&quot;+window.getSelection().toString());window.location.reload();"><i class="fa fa-search"></i><span>百度搜索</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-too"><a class="rightMenu-item" href="javascript:window.open(window.getSelection().toString());window.location.reload();"><i class="fa fa-link"></i><span>转到链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-paste"><a class="rightMenu-item" href="javascript:rmf.paste()"><i class="fa fa-copy"></i><span>粘贴</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-post"><a class="rightMenu-item" href="#post-comment"><i class="fas fa-comment"></i><span>空降评论</span></a><a class="rightMenu-item" href="javascript:rmf.copyWordsLink()"><i class="fa fa-link"></i><span>复制本文地址</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-to"><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>新窗口打开</span></a><a class="rightMenu-item" id="menu-too" href="javascript:rmf.open()"><i class="fa fa-link"></i><span>转到链接</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制链接</span></a></div><div class="rightMenu-group rightMenu-line hide" id="menu-img"><a class="rightMenu-item" href="javascript:rmf.saveAs()"><i class="fa fa-download"></i><span>保存图片</span></a><a class="rightMenu-item" href="javascript:rmf.openWithNewTab()"><i class="fa fa-window-restore"></i><span>在新窗口打开</span></a><a class="rightMenu-item" href="javascript:rmf.copyLink()"><i class="fa fa-copy"></i><span>复制图片链接</span></a></div><div class="rightMenu-group rightMenu-line"><a class="rightMenu-item" href="javascript:randomPost()"><i class="fa fa-paper-plane"></i><span>随便逛逛</span></a><a class="rightMenu-item" href="javascript:switchNightMode();"><i class="fa fa-moon"></i><span>昼夜切换</span></a><a class="rightMenu-item" href="javascript:rmf.switchReadMode();"><i class="fa fa-book"></i><span>阅读模式</span></a><a class="rightMenu-item" href="/personal/about/"><i class="fa fa-info-circle"></i><span>关于博客</span></a><a class="rightMenu-item" href="javascript:toggleWinbox();"><i class="fas fa-cog"></i><span>美化设置</span></a><a class="rightMenu-item" href="javascript:rmf.fullScreen();"><i class="fas fa-expand"></i><span>切换全屏</span></a><a class="rightMenu-item" href="javascript:window.print();"><i class="fa-solid fa-print"></i><span>打印页面</span></a></div></div><div><script src="https://npm.elemecdn.com/vue@2.6.11"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><script>(()=>{
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://libertysea-github-io.vercel.app/',
      region: '',
      onCommentLoaded: function () {
        btf.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://libertysea-github-io.vercel.app/',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(function (res) {
      countELement.innerText = res[0].count
    }).catch(function (err) {
      console.error(err);
    });
  }

  const runFn = () => {
    init()
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') {
      setTimeout(runFn,0)
      return
    } 
    getScript('https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js').then(runFn)
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) btf.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else loadTwikoo()
  } else {
    window.loadOtherComment = () => {
      loadTwikoo()
    }
  }
})()</script></div><script defer src="/js/stopshaking.js"></script><script defer src="/js/copy.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><script defer data-pjax src="/js/readPercent.js"></script><script async src="/js/fps.js"></script><script async src="https://cdn1.tianli0.top/npm/vue@2.6.14/dist/vue.min.js"></script><script async src="https://cdn1.tianli0.top/npm/element-ui@2.15.6/lib/index.js"></script><script async src="//at.alicdn.com/t/c/font_3871375_n12pe0fwv7a.js"></script><script src="https://cdn.bootcdn.net/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script><script src="/js/share.js"></script><script src="/js/sun_moon.js" async></script><script async src="/js/console.js"></script><script async src="/js/title.js"></script><script async src="/js/bb.js"></script><script type="text/javascript" src="https://cdn1.tianli0.top/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/nav.js"></script><script src="/js/rightmenu.js"></script><script src="https://cdn.staticaly.com/gh/haonan15/CDN@main/source/waterfall.min.js"></script><script async src="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/categoryBar/categoryBar.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="biu,hi,biubiu~" data-fontsize="15px" data-random="false" async="async"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_swiper_injector_config(){
    var parent_div_git = document.getElementById('swiper_container');
    var item_html = '<div class="recent-post-item" style="height: auto;width: 100%"><div class="blog-slider swiper-container-fade swiper-container-horizontal" id="swiper_container"><div class="blog-slider__wrp swiper-wrapper" style="transition-duration: 0ms;"><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/01/11/computer-science/hexo/hexo-2/Hexo博客美化-二/" alt=""><img width="48" height="48" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giclxp31goj20zk0m8qv5.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-11</span><a class="blog-slider__title" href="2023/01/11/computer-science/hexo/hexo-2/Hexo博客美化-二/" alt="">Hexo博客美化(二)</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2023/01/11/computer-science/hexo/hexo-2/Hexo博客美化-二/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/01/13/computer-science/big-data/hadoop/hadoop总结及词频统计进阶/" alt=""><img width="48" height="48" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciundwu5j20zk0m8n9e.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-13</span><a class="blog-slider__title" href="2023/01/13/computer-science/big-data/hadoop/hadoop总结及词频统计进阶/" alt="">hadoop总结及词频统计进阶</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2023/01/13/computer-science/big-data/hadoop/hadoop总结及词频统计进阶/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/01/13/computer-science/hexo/hexo-3/博客优化-三/" alt=""><img width="48" height="48" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciusoyjnj219g0u0x56.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-13</span><a class="blog-slider__title" href="2023/01/13/computer-science/hexo/hexo-3/博客优化-三/" alt="">博客优化(三)</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2023/01/13/computer-science/hexo/hexo-3/博客优化-三/" alt="">详情   </a></div></div><div class="blog-slider__item swiper-slide" style="width: 750px; opacity: 1; transform: translate3d(0px, 0px, 0px); transition-duration: 0ms;"><a class="blog-slider__img" href="2023/01/11/computer-science/hexo/hexo-1/使用Hexo搭建个人blog-一/" alt=""><img width="48" height="48" src="https://xingqiu-tuchuang-1256524210.cos.ap-shanghai.myqcloud.com/16946/6833939bly1giciundwu5j20zk0m8n9e.jpg" alt="" onerror="this.src=https://unpkg.zhimg.com/akilar-candyassets/image/loading.gif; this.onerror = null;"/></a><div class="blog-slider__content"><span class="blog-slider__code">2023-01-11</span><a class="blog-slider__title" href="2023/01/11/computer-science/hexo/hexo-1/使用Hexo搭建个人blog-一/" alt="">使用Hexo搭建个人blog(一)</a><div class="blog-slider__text">再怎么看我也不知道怎么描述它的啦！</div><a class="blog-slider__button" href="2023/01/11/computer-science/hexo/hexo-1/使用Hexo搭建个人blog-一/" alt="">详情   </a></div></div></div><div class="blog-slider__pagination swiper-pagination-clickable swiper-pagination-bullets"></div></div></div>';
    console.log('已挂载butterfly_swiper')
    parent_div_git.insertAdjacentHTML("afterbegin",item_html)
    }
  var elist = 'undefined'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_swiper_injector_config();
  }
  else if (epage === cpage){
    butterfly_swiper_injector_config();
  }
  </script><script defer src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js"></script><script defer data-pjax src="https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js"></script><!-- hexo injector body_end end --></body></html>